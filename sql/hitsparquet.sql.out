Starting Impala Shell without Kerberos authentication
Connected to impala:21000
Server version: impalad version 1.4.0-cdh4-INTERNAL RELEASE (build 08fa3466dd8914356494919534641842ff3953e0)
Query: use bdm27
Query: explain select count(day) from hitsparquet where Year = 2013 and Month = 7
+----------------------------------------------------------+
| Explain String                                           |
+----------------------------------------------------------+
| Estimated Per-Host Requirements: Memory=98.00MB VCores=1 |
|                                                          |
| 03:AGGREGATE [MERGE FINALIZE]                            |
| |  output: sum(count(day))                               |
| |                                                        |
| 02:EXCHANGE [UNPARTITIONED]                              |
| |                                                        |
| 01:AGGREGATE                                             |
| |  output: count(day)                                    |
| |                                                        |
| 00:SCAN HDFS [bdm27.hitsparquet]                         |
|    partitions=1/12 size=5.67GB                           |
+----------------------------------------------------------+
Returned 12 row(s) in 0.03s
Query: select count(day) from hitsparquet where Year = 2013 and Month = 7
+------------+
| count(day) |
+------------+
| 413600217  |
+------------+
Returned 1 row(s) in 1.74s
Query: explain select count(day) from hitsparquet  where Year = 2013
+----------------------------------------------------------+
| Explain String                                           |
+----------------------------------------------------------+
| Estimated Per-Host Requirements: Memory=98.00MB VCores=1 |
|                                                          |
| 03:AGGREGATE [MERGE FINALIZE]                            |
| |  output: sum(count(day))                               |
| |                                                        |
| 02:EXCHANGE [UNPARTITIONED]                              |
| |                                                        |
| 01:AGGREGATE                                             |
| |  output: count(day)                                    |
| |                                                        |
| 00:SCAN HDFS [bdm27.hitsparquet]                         |
|    partitions=12/12 size=69.98GB                         |
+----------------------------------------------------------+
Returned 12 row(s) in 0.03s
Query: select count(day) from hitsparquet  where Year = 2013
+------------+
| count(day) |
+------------+
| 5117261513 |
+------------+
Returned 1 row(s) in 12.81s
Query: explain select day,ticker,max(lastPrice) as High ,min(lastPrice) as Low  from   hitsparquet WHERE ticker="IBM" AND lastPrice IS NOT NULL AND YEAR=2013 AND MONTH=07  GROUP by day,ticker ORDER by day
+-----------------------------------------------------------+
| Explain String                                            |
+-----------------------------------------------------------+
| Estimated Per-Host Requirements: Memory=274.00MB VCores=2 |
|                                                           |
| 05:MERGING-EXCHANGE [UNPARTITIONED]                       |
| |  order by: day ASC                                      |
| |                                                         |
| 02:SORT                                                   |
| |  order by: day ASC                                      |
| |                                                         |
| 04:AGGREGATE [MERGE FINALIZE]                             |
| |  output: max(max(lastPrice)), min(min(lastPrice))       |
| |  group by: day, ticker                                  |
| |                                                         |
| 03:EXCHANGE [HASH(day,ticker)]                            |
| |                                                         |
| 01:AGGREGATE                                              |
| |  output: max(lastPrice), min(lastPrice)                 |
| |  group by: day, ticker                                  |
| |                                                         |
| 00:SCAN HDFS [bdm27.hitsparquet]                          |
|    partitions=1/12 size=5.67GB                            |
|    predicates: ticker = 'IBM', lastPrice IS NOT NULL      |
+-----------------------------------------------------------+
Returned 21 row(s) in 0.02s
Query: select day,ticker,max(lastPrice) as High ,min(lastPrice) as Low  from   hitsparquet WHERE ticker="IBM" AND lastPrice IS NOT NULL AND YEAR=2013 AND MONTH=07  GROUP by day,ticker ORDER by day
+----------+--------+----------+----------+
| day      | ticker | high     | low      |
+----------+--------+----------+----------+
| 20130701 | IBM    | 193.8    | 191.1    |
| 20130702 | IBM    | 193.23   | 190.26   |
| 20130703 | IBM    | 194.22   | 190.51   |
| 20130705 | IBM    | 195.7    | 192.35   |
| 20130708 | IBM    | 195.78   | 194.61   |
| 20130709 | IBM    | 194.98   | 190.78   |
| 20130710 | IBM    | 193.48   | 191.2714 |
| 20130711 | IBM    | 194.11   | 192      |
| 20130712 | IBM    | 193.6999 | 191.5901 |
| 20130715 | IBM    | 194.89   | 191.68   |
| 20130716 | IBM    | 194.58   | 192.685  |
| 20130717 | IBM    | 202.5    | 188.82   |
| 20130718 | IBM    | 200.94   | 195.99   |
| 20130719 | IBM    | 197.99   | 193.24   |
| 20130722 | IBM    | 195.79   | 193.2804 |
| 20130723 | IBM    | 196.43   | 194.08   |
| 20130724 | IBM    | 197.5    | 195.85   |
| 20130725 | IBM    | 197.83   | 195.66   |
| 20130726 | IBM    | 197.37   | 195      |
| 20130729 | IBM    | 197.19   | 195.53   |
| 20130730 | IBM    | 197.83   | 195.81   |
| 20130731 | IBM    | 196.9099 | 193.32   |
+----------+--------+----------+----------+
Returned 22 row(s) in 5.13s
Query: explain select day,ticker,max(lastPrice) as High ,min(lastPrice) as Low  from   hitsparquet WHERE ticker="IBM" AND lastPrice IS NOT NULL AND YEAR=2013  GROUP by day,ticker ORDER by day
+-----------------------------------------------------------+
| Explain String                                            |
+-----------------------------------------------------------+
| Estimated Per-Host Requirements: Memory=302.39MB VCores=2 |
|                                                           |
| 05:MERGING-EXCHANGE [UNPARTITIONED]                       |
| |  order by: day ASC                                      |
| |                                                         |
| 02:SORT                                                   |
| |  order by: day ASC                                      |
| |                                                         |
| 04:AGGREGATE [MERGE FINALIZE]                             |
| |  output: max(max(lastPrice)), min(min(lastPrice))       |
| |  group by: day, ticker                                  |
| |                                                         |
| 03:EXCHANGE [HASH(day,ticker)]                            |
| |                                                         |
| 01:AGGREGATE                                              |
| |  output: max(lastPrice), min(lastPrice)                 |
| |  group by: day, ticker                                  |
| |                                                         |
| 00:SCAN HDFS [bdm27.hitsparquet]                          |
|    partitions=12/12 size=69.98GB                          |
|    predicates: ticker = 'IBM', lastPrice IS NOT NULL      |
+-----------------------------------------------------------+
Returned 21 row(s) in 0.03s
Query: select day,ticker,max(lastPrice) as High ,min(lastPrice) as Low  from   hitsparquet WHERE ticker="IBM" AND lastPrice IS NOT NULL AND YEAR=2013  GROUP by day,ticker ORDER by day
+----------+--------+----------+----------+
| day      | ticker | high     | low      |
+----------+--------+----------+----------+
| 20130102 | IBM    | 196.35   | 191.55   |
| 20130103 | IBM    | 196.35   | 194.44   |
| 20130104 | IBM    | 194.95   | 192.78   |
| 20130107 | IBM    | 194.3081 | 192.34   |
| 20130108 | IBM    | 193.3    | 191.605  |
| 20130109 | IBM    | 193.49   | 191.65   |
| 20130110 | IBM    | 192.98   | 191.28   |
| 20130111 | IBM    | 195      | 192.9    |
| 20130114 | IBM    | 194.7417 | 191.75   |
| 20130115 | IBM    | 192.75   | 190.39   |
| 20130116 | IBM    | 193.18   | 191.35   |
| 20130117 | IBM    | 194.46   | 192.83   |
| 20130118 | IBM    | 195      | 193.65   |
| 20130122 | IBM    | 205      | 194.01   |
| 20130123 | IBM    | 208.58   | 202.4    |
| 20130124 | IBM    | 205.06   | 203.08   |
| 20130125 | IBM    | 205.18   | 204.13   |
| 20130128 | IBM    | 206.22   | 204.15   |
| 20130129 | IBM    | 205.7301 | 203.64   |
| 20130130 | IBM    | 204.88   | 203.186  |
| 20130131 | IBM    | 204.4699 | 202.96   |
| 20130201 | IBM    | 205.4    | 203.07   |
| 20130204 | IBM    | 205.02   | 203.12   |
| 20130205 | IBM    | 205      | 202.51   |
| 20130206 | IBM    | 201.95   | 199.56   |
| 20130207 | IBM    | 201.42   | 198.68   |
| 20130208 | IBM    | 202.09   | 199.4963 |
| 20130211 | IBM    | 201.95   | 199.75   |
| 20130212 | IBM    | 200.735  | 199.02   |
| 20130213 | IBM    | 200.95   | 199.57   |
| 20130214 | IBM    | 200.32   | 199.01   |
| 20130215 | IBM    | 201.25   | 199.82   |
| 20130219 | IBM    | 201.89   | 200.22   |
| 20130220 | IBM    | 201.72   | 198.86   |
| 20130221 | IBM    | 199.23   | 198.11   |
| 20130222 | IBM    | 201.09   | 198.0563 |
| 20130225 | IBM    | 202.49   | 197.482  |
| 20130226 | IBM    | 199.9    | 197.2335 |
| 20130227 | IBM    | 202.75   | 198.6    |
| 20130228 | IBM    | 203.123  | 200      |
| 20130301 | IBM    | 203.49   | 199.36   |
| 20130304 | IBM    | 205.3    | 202.08   |
| 20130305 | IBM    | 207.7    | 205.19   |
| 20130306 | IBM    | 208.49   | 206.66   |
| 20130307 | IBM    | 209.6    | 208.24   |
| 20130308 | IBM    | 210.74   | 209.1    |
| 20130311 | IBM    | 210.1999 | 209.04   |
| 20130312 | IBM    | 210.73   | 208.82   |
| 20130313 | IBM    | 212.36   | 209.65   |
| 20130314 | IBM    | 215.99   | 212      |
| 20130315 | IBM    | 215.9    | 213.41   |
| 20130318 | IBM    | 214.5    | 212.62   |
| 20130319 | IBM    | 215.12   | 211.829  |
| 20130320 | IBM    | 215.82   | 212.66   |
| 20130321 | IBM    | 214.15   | 210.11   |
| 20130322 | IBM    | 213.17   | 211.619  |
| 20130325 | IBM    | 213.26   | 210.05   |
| 20130326 | IBM    | 212.504  | 210.4281 |
| 20130327 | IBM    | 212.36   | 210.01   |
| 20130328 | IBM    | 213.44   | 209.67   |
| 20130401 | IBM    | 213.5    | 211.25   |
| 20130402 | IBM    | 214.71   | 211.57   |
| 20130403 | IBM    | 214.89   | 212.6    |
| 20130404 | IBM    | 213.13   | 210.04   |
| 20130405 | IBM    | 210.62   | 206.34   |
| 20130408 | IBM    | 209.9    | 207.34   |
| 20130409 | IBM    | 210      | 208.61   |
| 20130410 | IBM    | 212.51   | 210.47   |
| 20130411 | IBM    | 213.09   | 210.85   |
| 20130412 | IBM    | 213.2266 | 209.78   |
| 20130415 | IBM    | 211.69   | 208.75   |
| 20130416 | IBM    | 212.0212 | 209.2    |
| 20130417 | IBM    | 212      | 209.32   |
| 20130418 | IBM    | 210.35   | 195      |
| 20130419 | IBM    | 198.85   | 189.76   |
| 20130422 | IBM    | 191.38   | 187.68   |
| 20130423 | IBM    | 192.555  | 187.5896 |
| 20130424 | IBM    | 192.51   | 191.09   |
| 20130425 | IBM    | 195.17   | 192.32   |
| 20130426 | IBM    | 194.71   | 193.25   |
| 20130429 | IBM    | 199.68   | 194.31   |
| 20130430 | IBM    | 202.59   | 197.35   |
| 20130501 | IBM    | 203      | 199.2    |
| 20130502 | IBM    | 202.68   | 199.75   |
| 20130503 | IBM    | 205.319  | 202.94   |
| 20130506 | IBM    | 204.39   | 201.52   |
| 20130507 | IBM    | 203.73   | 201.65   |
| 20130508 | IBM    | 204.85   | 202.35   |
| 20130509 | IBM    | 205      | 202.72   |
| 20130510 | IBM    | 204.53   | 202.82   |
| 20130513 | IBM    | 204.47   | 202.22   |
| 20130514 | IBM    | 203.67   | 202.08   |
| 20130515 | IBM    | 203.84   | 202.04   |
| 20130516 | IBM    | 206.59   | 203.32   |
| 20130517 | IBM    | 209.5    | 204.83   |
| 20130520 | IBM    | 209.15   | 207.42   |
| 20130521 | IBM    | 209.48   | 207      |
| 20130522 | IBM    | 210.15   | 206.121  |
| 20130523 | IBM    | 208.61   | 205      |
| 20130524 | IBM    | 206.43   | 204.42   |
| 20130528 | IBM    | 208.93   | 207.05   |
| 20130529 | IBM    | 208.42   | 206.04   |
| 20130530 | IBM    | 210.99   | 206.25   |
| 20130531 | IBM    | 211.98   | 207.7    |
| 20130603 | IBM    | 210.05   | 207.33   |
| 20130604 | IBM    | 209      | 205.08   |
| 20130605 | IBM    | 206.29   | 202.4    |
| 20130606 | IBM    | 204.2    | 201.47   |
| 20130607 | IBM    | 206.35   | 203.8    |
| 20130610 | IBM    | 207.18   | 204.9    |
| 20130611 | IBM    | 205.95   | 202.51   |
| 20130612 | IBM    | 205.23   | 200.51   |
| 20130613 | IBM    | 204.4    | 200.15   |
| 20130614 | IBM    | 204.745  | 201.81   |
| 20130617 | IBM    | 205.1713 | 202.2    |
| 20130618 | IBM    | 206.09   | 202.87   |
| 20130619 | IBM    | 205.03   | 201.93   |
| 20130620 | IBM    | 201.7    | 195.01   |
| 20130621 | IBM    | 198.96   | 193.5401 |
| 20130624 | IBM    | 195.7024 | 191.34   |
| 20130625 | IBM    | 195.59   | 193.15   |
| 20130626 | IBM    | 196.23   | 194.5    |
| 20130627 | IBM    | 196.9    | 192.5    |
| 20130628 | IBM    | 195.65   | 188.41   |
| 20130701 | IBM    | 193.8    | 191.1    |
| 20130702 | IBM    | 193.23   | 190.26   |
| 20130703 | IBM    | 194.22   | 190.51   |
| 20130705 | IBM    | 195.7    | 192.35   |
| 20130708 | IBM    | 195.78   | 194.61   |
| 20130709 | IBM    | 194.98   | 190.78   |
| 20130710 | IBM    | 193.48   | 191.2714 |
| 20130711 | IBM    | 194.11   | 192      |
| 20130712 | IBM    | 193.6999 | 191.5901 |
| 20130715 | IBM    | 194.89   | 191.68   |
| 20130716 | IBM    | 194.58   | 192.685  |
| 20130717 | IBM    | 202.5    | 188.82   |
| 20130718 | IBM    | 200.94   | 195.99   |
| 20130719 | IBM    | 197.99   | 193.24   |
| 20130722 | IBM    | 195.79   | 193.2804 |
| 20130723 | IBM    | 196.43   | 194.08   |
| 20130724 | IBM    | 197.5    | 195.85   |
| 20130725 | IBM    | 197.83   | 195.66   |
| 20130726 | IBM    | 197.37   | 195      |
| 20130729 | IBM    | 197.19   | 195.53   |
| 20130730 | IBM    | 197.83   | 195.81   |
| 20130731 | IBM    | 196.9099 | 193.32   |
| 20130801 | IBM    | 197.17   | 195.04   |
| 20130802 | IBM    | 195.9    | 193.2215 |
| 20130805 | IBM    | 196.17   | 194.35   |
| 20130806 | IBM    | 193.5    | 190.27   |
| 20130807 | IBM    | 190.99   | 188.05   |
| 20130808 | IBM    | 189.87   | 186.79   |
| 20130809 | IBM    | 189.16   | 187      |
| 20130812 | IBM    | 189.556  | 186.89   |
| 20130813 | IBM    | 189.99   | 187.56   |
| 20130814 | IBM    | 189      | 186.9    |
| 20130815 | IBM    | 187      | 185.45   |
| 20130816 | IBM    | 186.46   | 185.12   |
| 20130819 | IBM    | 186.5    | 183.9787 |
| 20130820 | IBM    | 185.63   | 183.1685 |
| 20130821 | IBM    | 186.57   | 184.12   |
| 20130822 | IBM    | 186.25   | 182.8395 |
| 20130823 | IBM    | 185.74   | 184.57   |
| 20130826 | IBM    | 187      | 184.6    |
| 20130827 | IBM    | 184.5    | 182.5701 |
| 20130828 | IBM    | 183.47   | 181.1    |
| 20130829 | IBM    | 183.7    | 181.44   |
| 20130830 | IBM    | 182.99   | 181.51   |
| 20130903 | IBM    | 184.32   | 182.27   |
| 20130904 | IBM    | 184.19   | 182.31   |
| 20130905 | IBM    | 185      | 182.8395 |
| 20130906 | IBM    | 185      | 182.65   |
| 20130909 | IBM    | 185.49   | 183.1    |
| 20130910 | IBM    | 187.65   | 185.75   |
| 20130911 | IBM    | 190.87   | 186.5    |
| 20130912 | IBM    | 191.46   | 189.85   |
| 20130913 | IBM    | 193.1    | 190.69   |
| 20130916 | IBM    | 194.81   | 192.61   |
| 20130917 | IBM    | 194.15   | 191.83   |
| 20130918 | IBM    | 194.89   | 192      |
| 20130919 | IBM    | 195      | 193.22   |
| 20130920 | IBM    | 194.5    | 189.9953 |
| 20130923 | IBM    | 192.41   | 189.3301 |
| 20130924 | IBM    | 191.56   | 189.66   |
| 20130925 | IBM    | 191.38   | 188.5    |
| 20130926 | IBM    | 191.76   | 189.455  |
| 20130927 | IBM    | 190.22   | 186.45   |
| 20130930 | IBM    | 186.74   | 184.34   |
| 20131001 | IBM    | 186.79   | 184.65   |
| 20131002 | IBM    | 186.3099 | 184.4    |
| 20131003 | IBM    | 185.79   | 182.8395 |
| 20131004 | IBM    | 185.13   | 183.58   |
| 20131007 | IBM    | 183.31   | 181.5    |
| 20131008 | IBM    | 182.1    | 178.45   |
| 20131009 | IBM    | 181.67   | 179.02   |
| 20131010 | IBM    | 184.7725 | 181.32   |
| 20131011 | IBM    | 186.23   | 184.12   |
| 20131014 | IBM    | 187      | 184.42   |
| 20131015 | IBM    | 187.228  | 184.02   |
| 20131016 | IBM    | 187      | 174.8    |
| 20131017 | IBM    | 177      | 172.25   |
| 20131018 | IBM    | 175.73   | 173.25   |
| 20131021 | IBM    | 174.75   | 172.6301 |
| 20131022 | IBM    | 175.57   | 172.86   |
| 20131023 | IBM    | 176      | 174.27   |
| 20131024 | IBM    | 178.45   | 176.0143 |
| 20131025 | IBM    | 179.1    | 176.26   |
| 20131028 | IBM    | 177.89   | 176.2    |
| 20131029 | IBM    | 182.32   | 177.5    |
| 20131030 | IBM    | 182.18   | 179.55   |
| 20131031 | IBM    | 181.67   | 179.01   |
| 20131101 | IBM    | 180.339  | 178.88   |
| 20131104 | IBM    | 180.8    | 179.34   |
| 20131105 | IBM    | 180.22   | 170.3    |
| 20131106 | IBM    | 179.75   | 177.75   |
| 20131107 | IBM    | 181.39   | 176.99   |
| 20131108 | IBM    | 180.288  | 177.35   |
| 20131111 | IBM    | 183.39   | 180      |
| 20131112 | IBM    | 184.0487 | 182.26   |
| 20131113 | IBM    | 183.5684 | 181      |
| 20131114 | IBM    | 183.2    | 179.66   |
| 20131115 | IBM    | 183.36   | 181.16   |
| 20131118 | IBM    | 185      | 183.19   |
| 20131119 | IBM    | 186.2    | 184.15   |
| 20131120 | IBM    | 186.24   | 184.645  |
| 20131121 | IBM    | 185.89   | 183.411  |
| 20131122 | IBM    | 184.99   | 179.92   |
| 20131125 | IBM    | 181.6    | 177.82   |
| 20131126 | IBM    | 179.1977 | 177.2338 |
| 20131127 | IBM    | 180.18   | 177.6    |
| 20131129 | IBM    | 180.76   | 179      |
| 20131202 | IBM    | 179.9639 | 177.12   |
| 20131203 | IBM    | 178.23   | 175.64   |
| 20131204 | IBM    | 177.5    | 175.16   |
| 20131205 | IBM    | 176.86   | 175.28   |
| 20131206 | IBM    | 178      | 175.52   |
| 20131209 | IBM    | 178.18   | 176.83   |
| 20131210 | IBM    | 177.67   | 176.06   |
| 20131211 | IBM    | 177.76   | 175.09   |
| 20131212 | IBM    | 175.8    | 173.28   |
| 20131213 | IBM    | 174.38   | 172.6    |
| 20131216 | IBM    | 178.35   | 172.73   |
| 20131217 | IBM    | 178      | 175.1    |
| 20131218 | IBM    | 178.81   | 174.851  |
| 20131219 | IBM    | 180.54   | 177.68   |
| 20131220 | IBM    | 182      | 179.984  |
| 20131223 | IBM    | 182.93   | 180.61   |
| 20131224 | IBM    | 183.5    | 181.71   |
| 20131226 | IBM    | 185.56   | 183      |
| 20131227 | IBM    | 186.5    | 184.55   |
| 20131230 | IBM    | 186.7    | 184.67   |
| 20131231 | IBM    | 187.87   | 186.3    |
+----------+--------+----------+----------+
Returned 252 row(s) in 14.12s
Query: explain select distinct a.day FROM hitsparquet a INNER JOIN hitsparquet b USING (day) WHERE (a.month = 07 AND a.ticker = 'IBM' AND a.lastprice > 200.5) AND (b.month = 07 AND b.ticker = 'T' AND b.lastprice > 35.8)
+-----------------------------------------------------------+
| Explain String                                            |
+-----------------------------------------------------------+
| Estimated Per-Host Requirements: Memory=274.03MB VCores=2 |
|                                                           |
| 08:EXCHANGE [UNPARTITIONED]                               |
| |                                                         |
| 07:AGGREGATE [MERGE FINALIZE]                             |
| |  group by: a.day                                        |
| |                                                         |
| 06:EXCHANGE [HASH(a.day)]                                 |
| |                                                         |
| 03:AGGREGATE                                              |
| |  group by: a.day                                        |
| |                                                         |
| 02:HASH JOIN [INNER JOIN, PARTITIONED]                    |
| |  hash predicates: a.day = b.day                         |
| |                                                         |
| |--05:EXCHANGE [HASH(b.day)]                              |
| |  |                                                      |
| |  01:SCAN HDFS [bdm27.hitsparquet b]                     |
| |     partitions=1/12 size=5.67GB                         |
| |     predicates: b.ticker = 'T', b.lastprice > 35.8      |
| |                                                         |
| 04:EXCHANGE [HASH(a.day)]                                 |
| |                                                         |
| 00:SCAN HDFS [bdm27.hitsparquet a]                        |
|    partitions=1/12 size=5.67GB                            |
|    predicates: a.ticker = 'IBM', a.lastprice > 200.5      |
+-----------------------------------------------------------+
Returned 26 row(s) in 0.07s
Query: select distinct a.day FROM hitsparquet a INNER JOIN hitsparquet b USING (day) WHERE (a.month = 07 AND a.ticker = 'IBM' AND a.lastprice > 200.5) AND (b.month = 07 AND b.ticker = 'T' AND b.lastprice > 35.8)
+----------+
| day      |
+----------+
| 20130718 |
| 20130717 |
+----------+
Returned 2 row(s) in 7.19s
Query: explain select distinct a.day FROM hitsparquet a INNER JOIN hitsparquet b USING (day) WHERE (a.ticker = 'IBM' AND a.lastprice > 200.5) AND (b.ticker = 'T' AND b.lastprice > 35.8)
+-----------------------------------------------------------+
| Explain String                                            |
+-----------------------------------------------------------+
| Estimated Per-Host Requirements: Memory=274.34MB VCores=2 |
|                                                           |
| 08:EXCHANGE [UNPARTITIONED]                               |
| |                                                         |
| 07:AGGREGATE [MERGE FINALIZE]                             |
| |  group by: a.day                                        |
| |                                                         |
| 06:EXCHANGE [HASH(a.day)]                                 |
| |                                                         |
| 03:AGGREGATE                                              |
| |  group by: a.day                                        |
| |                                                         |
| 02:HASH JOIN [INNER JOIN, PARTITIONED]                    |
| |  hash predicates: a.day = b.day                         |
| |                                                         |
| |--05:EXCHANGE [HASH(b.day)]                              |
| |  |                                                      |
| |  01:SCAN HDFS [bdm27.hitsparquet b]                     |
| |     partitions=12/12 size=69.98GB                       |
| |     predicates: b.ticker = 'T', b.lastprice > 35.8      |
| |                                                         |
| 04:EXCHANGE [HASH(a.day)]                                 |
| |                                                         |
| 00:SCAN HDFS [bdm27.hitsparquet a]                        |
|    partitions=12/12 size=69.98GB                          |
|    predicates: a.ticker = 'IBM', a.lastprice > 200.5      |
+-----------------------------------------------------------+
Returned 26 row(s) in 0.05s
Query: select distinct a.day FROM hitsparquet a INNER JOIN hitsparquet b USING (day) WHERE (a.ticker = 'IBM' AND a.lastprice > 200.5) AND (b.ticker = 'T' AND b.lastprice > 35.8)
+----------+
| day      |
+----------+
| 20130311 |
| 20130524 |
| 20130227 |
| 20130617 |
| 20130404 |
| 20130313 |
| 20130325 |
| 20130618 |
| 20130607 |
| 20130326 |
| 20130502 |
| 20130417 |
| 20130321 |
| 20130516 |
| 20130717 |
| 20130408 |
| 20130416 |
| 20130305 |
| 20130411 |
| 20130612 |
| 20130409 |
| 20130501 |
| 20130418 |
| 20130528 |
| 20130213 |
| 20130314 |
| 20130507 |
| 20130613 |
| 20130530 |
| 20130304 |
| 20130315 |
| 20130415 |
| 20130405 |
| 20130520 |
| 20130517 |
| 20130718 |
| 20130503 |
| 20130327 |
| 20130606 |
| 20130308 |
| 20130529 |
| 20130614 |
| 20130318 |
| 20130515 |
| 20130611 |
| 20130430 |
| 20130604 |
| 20130521 |
| 20130306 |
| 20130220 |
| 20130228 |
| 20130509 |
| 20130320 |
| 20130510 |
| 20130322 |
| 20130410 |
| 20130522 |
| 20130506 |
| 20130523 |
| 20130328 |
| 20130514 |
| 20130312 |
| 20130412 |
| 20130401 |
| 20130513 |
| 20130301 |
| 20130508 |
| 20130610 |
| 20130225 |
| 20130402 |
| 20130619 |
| 20130319 |
| 20130403 |
| 20130307 |
+----------+
Returned 74 row(s) in 507.98s
